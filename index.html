<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>WTF Kima</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Fredoka:wght@400;700&display=swap');
  * { box-sizing: border-box; }
  body {
    background-color: #ffe6f0;
    font-family: 'Fredoka', sans-serif;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100vh;
    margin: 0;
    overflow: hidden;
    text-align: center;
  }
  h1 {
    font-size: 2rem;
    margin: 0 20px 20px;
  }
  .btn-container {
    display: flex;
    gap: 20px;
    position: relative;
  }
  button {
    font-size: 1.2rem;
    padding: 10px 20px;
    border: none;
    border-radius: 10px;
    cursor: pointer;
    transition: all 0.3s ease;
  }
  #yes-btn {
    background-color: #ff66b2;
    color: white;
    font-size: 1.4rem;
  }
  #no-btn {
    background-color: #cccccc;
    color: black;
    position: absolute;
  }
  #celebration-screen {
    display: none;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
    height: 100vh;
    width: 100vw;
    background-color: #fff0f5;
    position: fixed;
    top: 0;
    left: 0;
    z-index: 999;
    padding: 20px;
    overflow: hidden;
  }
  #celebration-message {
    font-size: 2rem;
    color: #ff3399;
    margin-bottom: 10px;
    margin-top: 10px;
  }
  #small-text {
    font-size: 1rem;
    color: #aa3377;
    margin-bottom: 20px;
  }
  #balloons-container {
    position: relative;
    height: 50vh;
    width: 100%;
    overflow: visible;
  }
  .balloon {
    width: 30px;
    height: 40px;
    background-color: #ff69b4;
    border-radius: 50% 50% 50% 50%;
    position: absolute;
    animation: float 6s linear infinite;
  }
  @keyframes float {
    0% { transform: translateY(100vh) rotate(0deg); opacity: 0; }
    50% { opacity: 1; }
    100% { transform: translateY(-10vh) rotate(360deg); opacity: 0; }
  }
  #fireworks-canvas {
    position: absolute;
    top: 0;
    left: 0;
    width: 100vw;
    height: 50vh;
    pointer-events: none;
  }
  #password-section {
    margin-top: 20px;
  }
  #password-input {
    font-size: 1.2rem;
    padding: 8px;
    border-radius: 8px;
    border: 2px solid #ff66b2;
    width: 250px;
    max-width: 90vw;
  }
  #submit-password {
    font-size: 1.2rem;
    margin-left: 10px;
    padding: 8px 15px;
    background-color: #ff66b2;
    border: none;
    border-radius: 8px;
    color: white;
    cursor: pointer;
    transition: background-color 0.3s ease;
  }
  #submit-password:hover {
    background-color: #e0559e;
  }
  #card {
    display: none;
    background-color: white;
    border-radius: 20px;
    padding: 20px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    max-width: 300px;
    text-align: center;
    margin-top: 30px;
  }
  #blocked-message {
    color: #aa2255;
    font-weight: bold;
    font-size: 1.2rem;
    margin-top: 15px;
  }
</style>
</head>
<body>
<h1>WTF quÃ© traes Kima ðŸ˜­<br>Â¿Me perdonas?</h1>
<div class="btn-container">
  <button id="yes-btn">SÃ­</button>
  <button id="no-btn">No</button>
</div>

<div id="celebration-screen">
  <div id="balloons-container"></div>
  <canvas id="fireworks-canvas"></canvas>
  <div id="celebration-message">Â¡SabÃ­a que me querÃ­as! ðŸ’˜</div>
  <div id="small-text">Ingresa la contraseÃ±a para desbloquear una cartita muy especial.</div>

  <div id="password-section">
    <input type="password" id="password-input" placeholder="ContraseÃ±a secreta" autocomplete="off" />
    <button id="submit-password">Enviar</button>
  </div>

  <div id="card">
    <h2>Mi cartita para ti ðŸ’Œ</h2>
    <p>Eres la persona que alegra mis dÃ­as, incluso cuando no sabes que lo haces. Gracias por estar. ðŸ’–</p>
  </div>

  <div id="blocked-message" style="display:none;">
    Lo siento, agotaste tus intentos. Intenta de nuevo en 2 horas.
  </div>
</div>

<script>
  // Globally used elements
  const yesBtn = document.getElementById("yes-btn");
  const noBtn = document.getElementById("no-btn");
  const celebrationScreen = document.getElementById("celebration-screen");
  const balloonsContainer = document.getElementById("balloons-container");
  const card = document.getElementById("card");
  const blockedMessage = document.getElementById("blocked-message");
  const passwordInput = document.getElementById("password-input");
  const submitPassword = document.getElementById("submit-password");
  const fireworksCanvas = document.getElementById("fireworks-canvas");
  const ctx = fireworksCanvas.getContext("2d");

  // Setup fireworks canvas size
  function resizeCanvas() {
    fireworksCanvas.width = window.innerWidth;
    fireworksCanvas.height = window.innerHeight * 0.5;
  }
  resizeCanvas();
  window.addEventListener('resize', resizeCanvas);

  // Fireworks implementation (simple)
  class Firework {
    constructor(x, y, color) {
      this.x = x;
      this.y = y;
      this.color = color;
      this.particles = [];
      this.exploded = false;
      this.life = 0;
      this.createParticles();
    }
    createParticles() {
      const particleCount = 30;
      for(let i=0; i<particleCount; i++) {
        const angle = (Math.PI * 2 / particleCount) * i;
        const speed = Math.random() * 4 + 2;
        this.particles.push({
          x: this.x,
          y: this.y,
          vx: Math.cos(angle) * speed,
          vy: Math.sin(angle) * speed,
          alpha: 1,
          radius: 2 + Math.random() * 2,
        });
      }
    }
    update() {
      this.life++;
      for(let p of this.particles) {
        p.x += p.vx;
        p.y += p.vy;
        p.alpha -= 0.02;
        if(p.alpha < 0) p.alpha = 0;
      }
    }
    draw(ctx) {
      for(let p of this.particles) {
        ctx.beginPath();
        ctx.arc(p.x, p.y, p.radius, 0, Math.PI * 2);
        ctx.fillStyle = `rgba(${this.color},${p.alpha})`;
        ctx.fill();
      }
    }
    isDead() {
      return this.particles.every(p => p.alpha <= 0);
    }
  }

  let fireworks = [];

  function launchFirework() {
    const x = Math.random() * fireworksCanvas.width;
    const y = Math.random() * fireworksCanvas.height * 0.7;
    const r = Math.floor(Math.random() * 255);
    const g = Math.floor(Math.random() * 100);
    const b = Math.floor(Math.random() * 255);
    const color = `${r},${g},${b}`;
    fireworks.push(new Firework(x, y, color));
  }

  function animate() {
    ctx.clearRect(0, 0, fireworksCanvas.width, fireworksCanvas.height);
    fireworks.forEach((fw, i) => {
      fw.update();
      fw.draw(ctx);
      if(fw.isDead()) fireworks.splice(i, 1);
    });
    requestAnimationFrame(animate);
  }

  // Balloons floating animation
  function createBalloon() {
    const balloon = document.createElement("div");
    balloon.className = "balloon";
    balloon.style.left = Math.random() * 100 + "vw";
    balloon.style.backgroundColor = `hsl(${Math.random() * 360}, 70%, 70%)`;
    balloon.style.animationDelay = (Math.random() * 3) + "s";
    balloonsContainer.appendChild(balloon);
    setTimeout(() => balloon.remove(), 6000);
  }

  function startCelebration() {
    balloonsContainer.innerHTML = "";
    for(let i = 0; i < 15; i++) {
      setTimeout(createBalloon, i * 400);
    }
    animate();
  }

  // Password logic
  let attempts = 0;

  function isBlocked() {
    const blockedUntil = localStorage.getItem('blockedUntil');
    if (!blockedUntil) return false;
    return new Date().getTime() < parseInt(blockedUntil);
  }

  function blockFor2Hours() {
    const twoHoursLater = new Date().getTime() + 2 * 60 * 60 * 1000;
    localStorage.setItem('blockedUntil', twoHoursLater);
  }

  yesBtn.addEventListener("click", () => {
    if (isBlocked()) {
      alert("Lo siento, agotaste tus intentos. Intenta de nuevo en 2 horas.");
      return;
    }
    // Mostrar pantalla celebraciÃ³n
    document.body.innerHTML = "";
    document.body.appendChild(celebrationScreen);
    celebrationScreen.style.display = "flex";
    startCelebration();
  });

  submitPassword.addEventListener("click", () => {
    if (isBlocked()) {
      blockedMessage.style.display = "block";
      return;
    }
    const pw = passwordInput.value.trim().toLowerCase();
    if(pw === "") {
      alert("Por favor ingresa la contraseÃ±a.");
      return;
    }
    if (pw === "120603051003") {
      card.style.display = "block";
      blockedMessage.style.display = "none";
      submitPassword.disabled = true;
      passwordInput.disabled = true;
    } else {
      attempts++;
      if(attempts >= 3) {
        blockedMessage.style.display = "block";
        blockFor2Hours();
        alert("Lo siento, agotaste tus intentos. Intenta de nuevo en 2 horas.");
        submitPassword.disabled = true;
        passwordInput.disabled = true;
      } else {
        alert(`ContraseÃ±a incorrecta, te quedan ${3 - attempts} intento(s).`);
      }
    }
    passwordInput.value = "";
    passwordInput.focus();
  });

  // No button moves randomly but stays visible on screen
  noBtn.addEventListener("mouseover", () => {
    const padding = 40;
    const maxX = window.innerWidth - noBtn.offsetWidth - padding;
    const maxY = window.innerHeight - noBtn.offsetHeight - padding - 30;
    const x = Math.random() * maxX;
    const y = Math.random() * maxY;
    noBtn.style.left = `${x}px`;
    noBtn.style.top = `${y}px`;
  });

</script>
</body>
</html>
